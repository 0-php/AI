<?
include("../Perceptron.php");
/**
 * Example
 */
	$filename = 'w1.json';

	/**
	 * Наш перцептрон будет говорить что дали на вход, квадрат или прямую.
	 * Следует учесть, что в этом примере перцептрона спрашивают о том, чего небыло в учении.
	 */

	$neural = new Perceptron(64);	// матрица будет 8х8, размерность 64.

	if(!isset($filename))
	{

		/**
		 * Учим квадраты
		 */
		$v1 =	array(1, 1, 1, 1, 1, 1, 1, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 1, 1, 1, 1, 1, 1, 1,
		              );
		$neural->teach( $v1, 1 );
		$v1 =	array(0, 1, 1, 1, 1, 1, 1, 1,
		              0, 1, 0, 0, 0, 0, 0, 1,
		              0, 1, 0, 0, 0, 0, 0, 1,
		              0, 1, 0, 0, 0, 0, 0, 1,
		              0, 1, 0, 0, 0, 0, 0, 1,
		              0, 1, 0, 0, 0, 0, 0, 1,
		              0, 1, 0, 0, 0, 0, 0, 1,
		              0, 1, 1, 1, 1, 1, 1, 1,
		              );
		$neural->teach( $v1, 1 );
		$v1 =	array(0, 0, 0, 0, 0, 0, 0, 0,
		              1, 1, 1, 1, 1, 1, 1, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 1, 1, 1, 1, 1, 1, 1,
		              );
		$neural->teach( $v1, 1 );
		$v1 =	array(0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              1, 1, 1, 1, 1, 1, 1, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 1, 1, 1, 1, 1, 1, 1,
		              );
		$neural->teach( $v1, 1 );
		$v1 =	array(0, 0, 1, 1, 1, 1, 1, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 1, 1, 1, 1, 1,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              );
		$neural->teach( $v1, 1 );
		$v1 =	array(1, 1, 1, 1, 1, 1, 1, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 0, 0, 0, 0, 0, 0, 1,
		              1, 1, 1, 1, 1, 1, 1, 1,
		              );
		$neural->teach( $v1, 1 );




		/**
		 * Теперь учим прямые.
		 */
		$v1 =	array(1, 1, 1, 1, 1, 1, 1, 1,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              );
		$neural->teach( $v1,-1 );


		$v1 =	array(0, 0, 0, 0, 0, 0, 0, 1,
		              0, 0, 0, 0, 0, 0, 1, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 1, 0, 0, 0,
		              0, 0, 0, 1, 0, 0, 0, 0,
		              0, 0, 1, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              1, 0, 0, 0, 0, 0, 0, 0,
		              );
		$neural->teach( $v1,-1 );

		$v1 =	array(0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              1, 1, 1, 1, 1, 1, 1, 1,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              );
		$neural->teach( $v1, -1 );

		$v1 =	array(0, 1, 0, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              );
		$neural->teach( $v1,-1 );

		$v1 =	array(1, 0, 0, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              0, 0, 1, 0, 0, 0, 0, 0,
		              0, 0, 0, 1, 0, 0, 0, 0,
		              0, 0, 0, 0, 1, 0, 0, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 0, 0, 1, 0,
		              0, 0, 0, 0, 0, 0, 0, 1,
		              );
		$neural->teach( $v1,-1 );

		$v1 =	array(0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              0, 0, 0, 0, 0, 1, 0, 0,
		              );
		$neural->teach( $v1,-1 );


		/**
		 * Выучили небольшой выборкой.
		 * Запишем веса в файл.
		 */

		$neural->weight_save("w1.txt");
	}
	else
	{
		// Чтобы каждый раз не учится, грузим.
		$neural->weight_load($filename);;
	}


	// Даем на вход квадрат, которого нету в выборке
		$v1 =	array(0, 0, 1, 1, 1, 1, 1, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 0, 0, 0, 0, 1,
		              0, 0, 1, 1, 1, 1, 1, 1,
		              );
	echo $neural->ask( $v1 )==1?"Квадратик":"прямая";
	echo "\r\n";
	// Еще один
		$v1 =	array(0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 1, 1, 1, 1, 1, 0,
		              0, 0, 1, 0, 0, 0, 1, 0,
		              0, 0, 1, 0, 0, 0, 1, 0,
		              0, 0, 1, 0, 0, 0, 1, 0,
		              0, 0, 1, 0, 0, 0, 1, 0,
		              0, 0, 1, 1, 1, 1, 1, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              );
	echo $neural->ask( $v1 )==1?"Квадратик":"прямая";
	echo "\r\n";

	// Теперь спросим про линии
		$v1 =	array(0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              1, 1, 1, 1, 1, 1, 1, 1,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              );

	echo $neural->ask( $v1 )==1?"Квадратик":"прямая";
	echo "\r\n";

		// Здесь просим про прямую длиной 5, а не 8.
		$v1 =	array(0, 0, 0, 0, 1, 0, 0, 0,
		              0, 0, 0, 1, 0, 0, 0, 0,
		              0, 0, 1, 0, 0, 0, 0, 0,
		              0, 1, 0, 0, 0, 0, 0, 0,
		              1, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              0, 0, 0, 0, 0, 0, 0, 0,
		              );

	echo $neural->ask( $v1 )==1?"Квадратик":"прямая";
	echo "\r\n";
?>